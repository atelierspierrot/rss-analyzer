<?php
/* @var \WebSyndication\StdClass $xml */
if (!isset($xml) || empty($xml)) return '';

$item_image         = $xml->getTagItem('image');
$item_title         = $xml->getTagItem('title');
$item_date          = $xml->getTagItem('updated_date');
$item_link          = $xml->getTagItem('item_link');
$item_description   = $xml->getTagItem('description');
$item_subtitle      = $xml->getTagItem('subtitle');
$item_author        = $xml->getTagItem('author');
$item_categories    = $xml->getTagItem('category');
$item_media         = $xml->getTagItem('media');

?>
<div class="item-wrapper <?php echo \WebSyndication\Helper::getClass('item_wrapper'); ?>">

    <div class="item-title <?php echo \WebSyndication\Helper::getClass('item_title'); ?>">

<?php if (!empty($item_link)) : ?>
        <a href="<?php echo $item_link->content; ?>" title="<?php 
            echo (isset($item_link->title) ? $item_link->title->content : 'See online');
        ?>">
<?php endif; ?>

            <?php echo $item_title->content; ?>

<?php if (!empty($item_link)) : ?>
        </a>
<?php endif; ?>

    </div>

    <div class="item-content <?php echo \WebSyndication\Helper::getClass('item_content'); ?>">

<?php if (!empty($item_date)) : ?>
        <div class="item-date <?php echo \WebSyndication\Helper::getClass('item_date'); ?>">
            <?php echo \WebSyndication\Helper::renderView(
                \WebSyndication\Helper::getTemplate('date_tag_template'),
                array('xml' => $item_date, 'alt_class' => 'item')
            ); ?>
        </div>
<?php endif; ?>

<?php if (!empty($item_image)) : ?>
        <?php echo \WebSyndication\Helper::renderView(
            \WebSyndication\Helper::getTemplate('image_tag_template'),
            array('xml' => $item_image, 'alt_class' => 'item')
        ); ?>
<?php endif; ?>

<?php if (!empty($item_subtitle)) : ?>
        <div class="item-subtitle <?php echo \WebSyndication\Helper::getClass('item_subtitle'); ?>">
            <?php echo $item_subtitle->getXmlValue(); ?>
        </div>
<?php endif; ?>

<?php if (!empty($item_description)) : ?>
        <div class="item-description <?php echo \WebSyndication\Helper::getClass('item_description'); ?>">
            <?php echo $item_description->getXmlValue(); ?>
        </div>
<?php endif; ?>

<?php if (!empty($item_categories)) : ?>
        <div class="item-categories-list <?php echo \WebSyndication\Helper::getClass('item_categories_list'); ?>">
        Categories&nbsp;:&nbsp;
    <?php foreach($item_categories->content as $i=>$_cat) : ?>
        <?php echo \WebSyndication\Helper::renderView(
            \WebSyndication\Helper::getTemplate('category_tag_template'),
            array('xml' => $_cat, 'alt_class' => 'item')
        ); 
        $i++;
        if ($i<count($item_categories->content)) echo ', ';
        ?>
    <?php endforeach; ?>
        </div>
<?php endif; ?>

<?php if (!empty($item_author)) : ?>
        <div class="item-author <?php echo \WebSyndication\Helper::getClass('item_author'); ?>">
            <?php echo \WebSyndication\Helper::renderView(
                \WebSyndication\Helper::getTemplate('person_tag_template'),
                array('xml' => $item_author, 'alt_class' => 'item')
            ); ?>
        </div>
<?php endif; ?>

<?php if (!empty($item_media)) : ?>
        <div class="item-media <?php echo \WebSyndication\Helper::getClass('item_media'); ?>">
            <?php echo \WebSyndication\Helper::renderView(
                \WebSyndication\Helper::getTemplate('media_tag_template'),
                array('xml' => $item_media, 'alt_class' => 'item')
            ); ?>
        </div>
<?php endif; ?>

    </div>

</div>
